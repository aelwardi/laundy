{% extends 'base.html.twig' %}

{% block title %}Profil - {{ parent() }}{% endblock %}

{% block content %}

  <main class="max-w-5xl mx-auto mt-30">
    <section>
      <h2 class="text-2xl font-bold mb-4 text-gray-500 border-b-2 border-gray-300">Informations personnelles</h2>
      {{ form_start(infoForm) }}
        <div class="space-y-4 mb-2">
          <div class="flex gap-4">
            <div class="flex-1">
              {{ form_row(infoForm.firstName) }}
            </div>
            <div class="flex-1">
              {{ form_row(infoForm.lastName) }}
            </div>
          </div>
        </div>
          {{ form_row(infoForm.phone) }}
          {{ form_row(infoForm.email) }}
          <button
          class="bg-blue-500 text-white font-semibold rounded px-8 py-2 hover:bg-blue-400 transition">Enregistrer</button>
      {{ form_end(infoForm) }}
    </section>

    <section class="mt-10">
      <h2 class="text-2xl font-bold text-gray-500 border-b-2 border-gray-300 mb-4">Changer de mot de passe</h2>
      {{ form_start(passwordForm) }}
        <div class="space-y-3">
          {{ form_row(passwordForm.current_password) }}
          {{ form_row(passwordForm.plainPassword) }}
          {{ form_row(passwordForm.confirmPassword) }}
          <button type="submit"
            class="bg-blue-500 text-white font-semibold rounded px-8 py-2 hover:bg-blue-400 transition">Valider</button>
        </div>
      {{ form_end(passwordForm) }}
    </section>

    <section class="mt-10">
      <h2 class="text-2xl font-bold mb-4 text-gray-500 border-b-2 border-gray-300">Adresses</h2>
      {{ form_start(addressForm, {'attr': {'class': 'space-y-4 mb-6'}}) }}
          {{ form_widget(addressForm.address) }}
          
          <div class="flex gap-3">
              {% for choice in addressForm.type %}
                  <label class="flex-1">
                      {{ form_widget(choice, {'attr': {'class': 'peer sr-only'}}) }}
                      <div class="
                          flex items-center justify-center gap-2 rounded px-0 py-2 border font-semibold shadow-sm cursor-pointer
                          {% if loop.first %}
                              border-blue-500
                              bg-blue-800 text-blue-500 peer-checked:bg-blue-800 peer-checked:text-blue-500 peer-checked:border-blue-500
                              bg-white text-gray-700 hover:bg-blue-100
                          {% else %}
                              border-gray-300
                              bg-white text-gray-700 peer-checked:bg-blue-800 peer-checked:text-blue-500 peer-checked:border-blue-500
                              hover:bg-blue-100
                          {% endif %}
                          transition
                      ">
                          {% if choice.vars.value == 'accueil' %}
                              <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                  <path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3" stroke-linecap="round" stroke-linejoin="round" />
                              </svg>
                          {% elseif choice.vars.value == 'bureau' %}
                              <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                  <path d="M4 7V4a1 1 0 011-1h14a1 1 0 011 1v3m-2 7v4a1 1 0 01-1 1H7a1 1 0 01-1-1v-4m4-6h4v4h-4V8z" stroke-linecap="round" stroke-linejoin="round" />
                              </svg>
                          {% elseif choice.vars.value == 'hotel' %}
                              <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                  <path d="M8 21V19a4 4 0 014-4h0a4 4 0 014 4v2M12 3v1m0 4v10" stroke-linecap="round" stroke-linejoin="round" />
                              </svg>
                          {% endif %}
                          {{ choice.vars.label }}
                      </div>
                  </label>
              {% endfor %}
          </div>

          {{ form_widget(addressForm.details) }}

          <button
              class="bg-blue-500 text-white font-semibold rounded px-8 py-2 hover:bg-blue-400 transition">Ajouter</button>
      {{ form_end(addressForm) }}

      <div class="flex flex-wrap gap-4">
        {% for address in addresses %}
          <div
            class="bg-gray-50 border border-gray-200 rounded-lg px-6 py-4 flex flex-col min-w-[250px] relative shadow-sm transition hover:shadow-lg">
            <div class="absolute top-2 right-2 flex gap-2">
                <form method="post" action="{{ path('app_profile_address_delete', {id: address.id}) }}"
                      onsubmit="return confirm('Supprimer cette adresse ?');">
                    <input type="hidden" name="_token" value="{{ csrf_token('delete_address_' ~ address.id) }}">
                    <button class="text-red-500 hover:text-red-700" title="Supprimer" type="submit">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                    </button>
                </form>
            </div>
            <div class="font-bold text-sm mt-6">{{ address.address }}</div>
            <div class="text-xs font-semibold text-gray-500 mb-1">{{ address.type.value }}</div>
            <div class="text-xs text-gray-600">{{ address.details }}</div>
          </div>
        {% endfor %}
      </div>
    </section>
  </main>
{% endblock %}